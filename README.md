# Web打刻ツール

![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)

会社のWeb打刻システムを自動化するデスクトップツールです。タスクトレイに常駐し、定期的に打刻確認を行います。

<img src="docs/screenshot.png" alt="スクリーンショット" width="500"/>

## 特徴

- タスクトレイに常駐するデスクトップアプリケーション
- 15分ごとに打刻確認のポップアップ表示
- 1日1回の出勤打刻と退勤打刻
- 朝12時までは出勤打刻の確認
- タスクトレイクリックで退勤打刻
- 出勤打刻済みで退勤打刻がない場合、夜10時に自動退勤打刻
- Web打刻システムへの自動アクセス
- ID・パスワードの暗号化保存
- Web要素のセレクタをGUIから設定可能

## 必要条件

- Python 3.8以上
- 必要なライブラリ（requirements.txtに記載）

## インストール方法

1. リポジトリをクローンまたはダウンロードします：

```bash
git clone https://github.com/xtc1988/web-dakoku-tool.git
cd web-dakoku-tool
```

または、GitHubの[リポジトリページ](https://github.com/xtc1988/web-dakoku-tool)から「Code」→「Download ZIP」でダウンロードし、解凍してください。

2. 必要なライブラリをインストールします：

**方法1: バッチファイルを使用する場合（推奨）**
- `install_dependencies.bat` をダブルクリックするだけで必要なライブラリがインストールされます。

**方法2: コマンドラインを使用する場合**
```bash
pip install -r requirements.txt
```

## 使い方

1. アプリケーションを起動します：

```bash
python main.py
```

または、Windowsの場合は`start_dakoku.bat`をダブルクリックします。

2. 初回起動時に設定画面が表示されるので、Web打刻システムのURL、ユーザーID、パスワードを入力します。
3. 「詳細設定」タブでWeb要素のセレクタを設定します（実際のWeb打刻システムに合わせて調整）。
4. 設定完了後、アプリケーションはタスクトレイに常駐します。
5. 朝12時までは15分ごとに出勤打刻の確認ポップアップが表示されます。
6. タスクトレイアイコンをクリックすると退勤打刻が行われます。
7. 出勤打刻済みで退勤打刻がない場合、夜10時に自動的に退勤打刻が行われます。

## 他のPCでの使用方法

他のPCでWeb打刻ツールを使用するには、以下の手順に従ってください：

1. 新しいPCにPython（3.8以上）をインストールします。
   - [Python公式サイト](https://www.python.org/downloads/)からダウンロードしてインストール
   - インストール時に「Add Python to PATH」にチェックを入れることを忘れないでください

2. リポジトリをクローンまたはダウンロードします。
   - GitHubの[リポジトリページ](https://github.com/xtc1988/web-dakoku-tool)から「Code」→「Download ZIP」でダウンロードし、解凍

3. 必要なライブラリをインストールします：
   - `install_dependencies.bat` をダブルクリックするだけでOK

4. アプリケーションを起動します：
   - `start_dakoku.bat` をダブルクリック

### 設定の移行

既存のPCから設定を移行する場合は、以下のファイルを新しいPCにコピーします：

1. `%USERPROFILE%\.web_dakoku\config.json`
2. `%USERPROFILE%\.web_dakoku\key.bin`

これらのファイルは、ユーザーのホームディレクトリ内の`.web_dakoku`フォルダにあります。

## Web要素セレクタの設定

Web打刻システムの要素IDは、「詳細設定」タブで設定できます。以下の要素IDを設定する必要があります：

1. ユーザーID入力: ユーザーID入力フィールドのID
2. パスワード入力: パスワード入力フィールドのID
3. ログインボタン: ログインボタンのID
4. 打刻パネル: ログイン成功後に表示される打刻パネルのID
5. 出勤打刻ボタン: 出勤打刻ボタンのID
6. 退勤打刻ボタン: 退勤打刻ボタンのID
7. 確認ボタン: 打刻確認ダイアログのOKボタンのID
8. 成功メッセージ: 打刻成功時に表示されるメッセージ要素のID

設定後、「テスト接続」ボタンをクリックして、設定が正しいか確認できます。

## 注意事項

- このツールは、特定のWeb打刻システムに対応するように設計されています。実際のWeb打刻システムに合わせて、Web要素のセレクタを設定する必要があります。
- ID・パスワードは暗号化されてローカルに保存されますが、完全なセキュリティを保証するものではありません。
- 会社のポリシーに従って使用してください。

## 貢献方法

1. このリポジトリをフォークします
2. 新しいブランチを作成します (`git checkout -b feature/amazing-feature`)
3. 変更をコミットします (`git commit -m 'Add some amazing feature'`)
4. ブランチにプッシュします (`git push origin feature/amazing-feature`)
5. プルリクエストを作成します

## ライセンス

MITライセンスの下で配布されています。詳細は[LICENSE](LICENSE)ファイルを参照してください。
